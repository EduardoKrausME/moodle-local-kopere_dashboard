!function(c){function b(f){return function(e){if(this===e.target){return f.apply(this,arguments)}}}var a=function(g,f){this.init(g,f)};a.prototype={constructor:a,init:function(f,h){this.$element=c(f);this.options=c.extend({},c.fn.modalmanager.defaults,this.$element.data(),typeof h=="object"&&h);this.stack=[];this.backdropCount=0;if(this.options.resize){var g,e=this;c(window).on("resize.modal",function(){g&&clearTimeout(g);g=setTimeout(function(){for(var i=0;i<e.stack.length;i++){e.stack[i].isShown&&e.stack[i].layout()}},10)})}},createModal:function(e,f){c(e).modal(c.extend({manager:this},f))},appendModal:function(e){this.stack.push(e);var f=this;e.$element.on("show.modalmanager",b(function(h){var g=function(){e.isShown=true;var i=c.support.transition&&e.$element.hasClass("fade");f.$element.toggleClass("modal-open",f.hasOpenModal()).toggleClass("page-overflow",c(window).height()<f.$element.height());e.$parent=e.$element.parent();e.$container=f.createContainer(e);e.$element.appendTo(e.$container);f.backdrop(e,function(){e.$element.show();if(i){e.$element[0].offsetWidth}e.layout();e.$element.addClass("in").attr("aria-hidden",false);var j=function(){f.setFocus();e.$element.trigger("shown")};i?e.$element.one(c.support.transition.end,j):j()})};e.options.replace?f.replace(g):g()}));e.$element.on("hidden.modalmanager",b(function(g){f.backdrop(e);if(e.$backdrop){c.support.transition&&e.$element.hasClass("fade")?e.$backdrop.one(c.support.transition.end,function(){f.destroyModal(e)}):f.destroyModal(e)}else{f.destroyModal(e)}}));e.$element.on("destroy.modalmanager",b(function(g){f.removeModal(e)}))},destroyModal:function(g){g.destroy();var f=this.hasOpenModal();this.$element.toggleClass("modal-open",f);if(!f){this.$element.removeClass("page-overflow")}this.removeContainer(g);this.setFocus()},hasOpenModal:function(){for(var f=0;f<this.stack.length;f++){if(this.stack[f].isShown){return true}}return false},setFocus:function(){var g;for(var f=0;f<this.stack.length;f++){if(this.stack[f].isShown){g=this.stack[f]}}if(!g){return}g.focus()},removeModal:function(f){f.$element.off(".modalmanager");if(f.$backdrop){this.removeBackdrop(f)}this.stack.splice(this.getIndexOfModal(f),1)},getModalAt:function(f){return this.stack[f]},getIndexOfModal:function(g){for(var f=0;f<this.stack.length;f++){if(g===this.stack[f]){return f}}},replace:function(f){var g;for(var e=0;e<this.stack.length;e++){if(this.stack[e].isShown){g=this.stack[e]}}if(g){this.$backdropHandle=g.$backdrop;g.$backdrop=null;f&&g.$element.one("hidden",b(c.proxy(f,this)));g.hide()}else{if(f){f()}}},removeBackdrop:function(f){f.$backdrop.remove();f.$backdrop=null},createBackdrop:function(e){var f;if(!this.$backdropHandle){f=c('<div class="modal-backdrop '+e+'" />').appendTo(this.$element)}else{f=this.$backdropHandle;f.off(".modalmanager");this.$backdropHandle=null;this.isLoading&&this.removeSpinner()}return f},removeContainer:function(f){f.$container.remove();f.$container=null},createContainer:function(f){var e;e=c('<div class="modal-scrollable">').css("z-index",d("modal",f?this.getIndexOfModal(f):this.stack.length)).appendTo(this.$element);if(f&&f.options.backdrop!="static"){e.on("click.modal",b(function(g){f.hide()}))}else{if(f){e.on("click.modal",b(function(g){f.attention()}))}}return e},backdrop:function(g,j){var f=g.$element.hasClass("fade")?"fade":"",h=g.options.backdrop&&this.backdropCount<this.options.backdropLimit;if(g.isShown&&h){var k=c.support.transition&&f&&!this.$backdropHandle;g.$backdrop=this.createBackdrop(f);g.$backdrop.css("z-index",d("backdrop",this.getIndexOfModal(g)));if(k){g.$backdrop[0].offsetWidth}g.$backdrop.addClass("in");this.backdropCount+=1;k?g.$backdrop.one(c.support.transition.end,j):j()}else{if(!g.isShown&&g.$backdrop){g.$backdrop.removeClass("in");this.backdropCount-=1;var e=this;c.support.transition&&g.$element.hasClass("fade")?g.$backdrop.one(c.support.transition.end,function(){e.removeBackdrop(g)}):e.removeBackdrop(g)}else{if(j){j()}}}},removeSpinner:function(){this.$spinner&&this.$spinner.remove();this.$spinner=null;this.isLoading=false},removeLoading:function(){this.$backdropHandle&&this.$backdropHandle.remove();this.$backdropHandle=null;this.removeSpinner()},loading:function(f){f=f||function(){};this.$element.toggleClass("modal-open",!this.isLoading||this.hasOpenModal()).toggleClass("page-overflow",c(window).height()<this.$element.height());if(!this.isLoading){this.$backdropHandle=this.createBackdrop("fade");this.$backdropHandle[0].offsetWidth;this.$backdropHandle.css("z-index",d("backdrop",this.stack.length)).addClass("in");var g=c(this.options.spinner).css("z-index",d("modal",this.stack.length)).appendTo(this.$element).addClass("in");this.$spinner=c(this.createContainer()).append(g).on("click.modalmanager",c.proxy(this.loading,this));this.isLoading=true;c.support.transition?this.$backdropHandle.one(c.support.transition.end,f):f()}else{if(this.isLoading&&this.$backdropHandle){this.$backdropHandle.removeClass("in");var e=this;c.support.transition?this.$backdropHandle.one(c.support.transition.end,function(){e.removeLoading()}):e.removeLoading()}else{if(f){f(this.isLoading)}}}}};var d=function(){var e,f={};return function(j,g){if(typeof e==="undefined"){var h=c('<div class="modal hide" />').appendTo("body"),k=c('<div class="modal-backdrop hide" />').appendTo("body");f.modal=+h.css("z-index");f.backdrop=+k.css("z-index");e=f.modal-f.backdrop;h.remove();k.remove();k=h=null}return f[j]+e*g}}();c.fn.modalmanager=function(f,e){return this.each(function(){var g=c(this),h=g.data("modalmanager");if(!h){g.data("modalmanager",h=new a(this,f))}if(typeof f==="string"){h[f].apply(h,[].concat(e))}})};c.fn.modalmanager.defaults={backdropLimit:999,resize:true,spinner:'<div class="loading-spinner fade" style="width: 200px; margin-left: -100px;"><div class="progress progress-striped active"><div class="bar" style="width: 100%;"></div></div></div>'};c.fn.modalmanager.Constructor=a}(jQuery);