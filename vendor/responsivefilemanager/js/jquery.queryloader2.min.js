(function(a){a.queryLoader2=function(b,d){var c=this;c.$el=a(b);c.el=b;c.$el.data("queryLoader2",c);c.qLimageContainer="";c.qLoverlay="";c.qLbar="";c.qLpercentage="";c.qLimages=[];c.qLbgimages=[];c.qLimageCounter=0;c.qLdone=0;c.qLdestroyed=false;c.init=function(){c.options=a.extend({},a.queryLoader2.defaultOptions,d);c.findImageInElement(c.el);if(c.options.deepSearch==true){c.$el.find("*:not(script)").each(function(){c.findImageInElement(this)})}c.createPreloadContainer();c.createOverlayLoader()};c.createPreloadContainer=function(){c.qLimageContainer=a("<div></div>").appendTo("body").css({display:"none",width:0,height:0,overflow:"hidden"});for(var e=0;c.qLbgimages.length>e;e++){a.ajax({url:c.qLbgimages[e],type:"HEAD",complete:function(f){if(!c.qLdestroyed){c.addImageForPreload(this["url"])}}})}};c.addImageForPreload=function(e){var f=a("<img />").attr("src",e);c.bindLoadEvent(f);f.appendTo(c.qLimageContainer)};c.createOverlayLoader=function(){var e="absolute";if(c.$el.prop("tagName")=="BODY"){e="fixed"}else{c.$el.css("position","relative")}c.qLoverlay=a("<div id='"+c.options.overlayId+"'></div>").css({width:"100%",height:"100%",backgroundColor:c.options.backgroundColor,backgroundPosition:"fixed",position:e,zIndex:666999,top:0,left:0}).appendTo(c.$el);c.qLbar=a("<div id='qLbar'></div>").css({height:"35px",marginTop:"0px",width:"0%",position:"absolute"}).appendTo(c.qLoverlay);if(c.options.percentage==true){c.qLpercentage=a("<div id='qLpercentage'></div>").text("0%").css({position:"absolute",bottom:"10px",right:"10px",textAlign:"center"}).appendTo(c.qLoverlay)}if(!c.qLimages.length){c.destroyContainers()}};c.destroyContainers=function(){c.qLdestroyed=true;c.qLimageContainer.remove();c.qLoverlay.remove()};c.findImageInElement=function(h){var l="";var g=a(h);var j="normal";if(g.css("background-image")!="none"){l=g.css("background-image");j="background"}else{if(typeof g.attr("src")!="undefined"&&h.nodeName.toLowerCase()=="img"){l=g.attr("src")}}if(l.indexOf("gradient")==-1){l=l.replace(/url\(\"/g,"");l=l.replace(/url\(/g,"");l=l.replace(/\"\)/g,"");l=l.replace(/\)/g,"");var k=l.split(", ");for(var f=0;f<k.length;f++){if(k[f].length>0&&c.qLimages.indexOf(k[f])==-1&&!k[f].match(/^(data:)/i)){var e="";if(c.isIE()||c.isOpera()){e="?rand="+Math.random();c.qLbgimages.push(k[f]+e)}else{if(j=="background"){c.qLbgimages.push(k[f])}else{c.bindLoadEvent(g)}}c.qLimages.push(k[f])}}}};c.isIE=function(){return navigator.userAgent.match(/msie/i)};c.isOpera=function(){return navigator.userAgent.match(/Opera/i)};c.bindLoadEvent=function(f){c.qLimageCounter++;imagesLoaded(f,function(){c.completeImageLoading(this)})};c.completeImageLoading=function(g){c.qLdone++;var f=c.qLdone/c.qLimageCounter*100;c.qLbar.stop().animate({width:f+"%",minWidth:f+"%"},200);if(c.options.percentage==true){c.qLpercentage.text(Math.ceil(f)+"%")}if(c.qLdone==c.qLimageCounter){c.endLoader()}};c.endLoader=function(){c.qLdestroyed=true;c.onLoadComplete()};c.onLoadComplete=function(){if(c.options.completeAnimation=="grow"){var e=500;c.qLbar.stop().animate({width:"100%"},e,function(){a(this).animate({top:"0%",width:"100%",height:"100%"},500,function(){a("#"+c.options.overlayId).fadeOut(500,function(){a(this).remove();c.destroyContainers();c.options.onComplete()})})})}else{a("#"+c.options.overlayId).fadeOut(500,function(){a("#"+c.options.overlayId).remove();c.destroyContainers();c.options.onComplete()})}};c.init()};a.queryLoader2.defaultOptions={onComplete:function(){},backgroundColor:"#000",barColor:"#fff",overlayId:"qLoverlay",barHeight:1,percentage:false,deepSearch:true,completeAnimation:"fade",minimumTime:500};a.fn.queryLoader2=function(b){return this.each(function(){new a.queryLoader2(this,b)})}})(jQuery);if(!Array.prototype.indexOf){Array.prototype.indexOf=function(b){var a=this.length>>>0;var c=Number(arguments[1])||0;c=c<0?Math.ceil(c):Math.floor(c);if(c<0){c+=a}for(;c<a;c++){if(c in this&&this[c]===b){return c}}return -1}};