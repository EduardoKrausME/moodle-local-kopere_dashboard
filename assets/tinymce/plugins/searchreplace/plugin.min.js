!function(){function b(C,H,v,F,j){function y(f,d){if(d=d||0,!f[0]){throw"findAndReplaceDOMText cannot handle zero-length matches"}var g=f.index;if(d>0){var c=f[d];if(!c){throw"Invalid capture group"}g+=f[0].indexOf(c),f[0]=c}return[g,g+f[0].length,[f[0]]]}function D(d){var c;if(3===d.nodeType){return d.data}if(z[d.nodeName]&&!G[d.nodeName]){return""}if(c="",(G[d.nodeName]||w[d.nodeName])&&(c+="\n"),d=d.firstChild){do{c+=D(d)}while(d=d.nextSibling)}return c}function q(K,O,m){var N,g,u,L,h=[],p=0,M=K,P=O.shift(),J=0;K:for(;;){if((G[M.nodeName]||w[M.nodeName])&&p++,3===M.nodeType&&(!g&&M.length+p>=P[1]?(g=M,L=P[1]-p):N&&h.push(M),!N&&M.length+p>P[0]&&(N=M,u=P[0]-p),p+=M.length),N&&g){if(M=m({startNode:N,startNodeIndex:u,endNode:g,endNodeIndex:L,innerNodes:h,match:P[2],matchIndex:J}),p-=g.length-L,N=null,g=null,h=[],P=O.shift(),J++,!P){break}}else{if((!z[M.nodeName]||G[M.nodeName])&&M.firstChild){M=M.firstChild;continue}if(M.nextSibling){M=M.nextSibling;continue}}for(;;){if(M.nextSibling){M=M.nextSibling;break}if(M.parentNode===K){break K}M=M.parentNode}}}function x(d){var c;if("function"!=typeof d){var f=d.nodeType?d:B.createElement(d);c=function(i,h){var g=f.cloneNode(!1);return g.setAttribute("data-mce-index",h),i&&g.appendChild(B.createTextNode(i)),g}}else{c=d}return function(R){var L,V,t,O=R.startNode,S=R.endNode,K=R.matchIndex;if(O===S){var N=O;t=N.parentNode,R.startNodeIndex>0&&(L=B.createTextNode(N.data.substring(0,R.startNodeIndex)),t.insertBefore(L,N));var T=c(R.match[0],K);return t.insertBefore(T,N),R.endNodeIndex<N.length&&(V=B.createTextNode(N.data.substring(R.endNodeIndex)),t.insertBefore(V,N)),N.parentNode.removeChild(N),T}L=B.createTextNode(O.data.substring(0,R.startNodeIndex)),V=B.createTextNode(S.data.substring(R.endNodeIndex));for(var X=c(O.data.substring(R.startNodeIndex),K),W=[],P=0,M=R.innerNodes.length;M>P;++P){var Q=R.innerNodes[P],J=c(Q.data,K);Q.parentNode.replaceChild(J,Q),W.push(J)}var U=c(S.data.substring(0,R.endNodeIndex),K);return t=O.parentNode,t.insertBefore(L,O),t.insertBefore(X,O),t.removeChild(O),t=S.parentNode,t.insertBefore(U,S),t.insertBefore(V,S),t.removeChild(S),U}}var E,I,B,G,z,w,A=[],k=0;if(B=H.ownerDocument,G=j.getBlockElements(),z=j.getWhiteSpaceElements(),w=j.getShortEndedElements(),I=D(H)){if(C.global){for(;E=C.exec(I);){A.push(y(E,F))}}else{E=I.match(C),A.push(y(E,F))}return A.length&&(k=A.length,q(H,A,x(v))),k}}function a(q){function g(){function i(){d.statusbar.find("#next").disabled(!k(u+1).length),d.statusbar.find("#prev").disabled(!k(u-1).length)}function l(){tinymce.ui.MessageBox.alert("Could not find the specified string.",function(){d.find("#find")[0].focus()})}var c={},d=tinymce.ui.Factory.create({type:"window",layout:"flex",pack:"center",align:"center",onClose:function(){q.focus(),m.done()},onSubmit:function(s){var r,w,n,v;return s.preventDefault(),w=d.find("#case").checked(),v=d.find("#words").checked(),n=d.find("#find").value(),n.length?c.text==n&&c.caseState==w&&c.wholeWord==v?0===k(u+1).length?void l():(m.next(),void i()):(r=m.find(n,w,v),r||l(),d.statusbar.items().slice(1).disabled(0===r),i(),void (c={text:n,caseState:w,wholeWord:v})):(m.done(!1),void d.statusbar.items().slice(1).disabled(!0))},buttons:[{text:"Find",onclick:function(){d.submit()}},{text:"Replace",disabled:!0,onclick:function(){m.replace(d.find("#replace").value())||(d.statusbar.items().slice(1).disabled(!0),u=-1,c={})}},{text:"Replace all",disabled:!0,onclick:function(){m.replace(d.find("#replace").value(),!0,!0),d.statusbar.items().slice(1).disabled(!0),c={}}},{type:"spacer",flex:1},{text:"Prev",name:"prev",disabled:!0,onclick:function(){m.prev(),i()}},{text:"Next",name:"next",disabled:!0,onclick:function(){m.next(),i()}}],title:"Find and replace",items:{type:"form",padding:20,labelGap:30,spacing:10,items:[{type:"textbox",name:"find",size:40,label:"Find",value:q.selection.getNode().src},{type:"textbox",name:"replace",size:40,label:"Replace with"},{type:"checkbox",name:"case",text:"Match case",label:" "},{type:"checkbox",name:"words",text:"Whole words",label:" "}]}}).renderTo().reflow()}function p(d){var c=d.getAttribute("data-mce-index");return"number"==typeof c?""+c:c}function e(i){var c,d;return d=q.dom.create("span",{"data-mce-bogus":1}),d.className="mce-match-marker",c=q.getBody(),m.done(!1),b(i,c,d,!1,q.schema)}function j(d){var c=d.parentNode;d.firstChild&&c.insertBefore(d.firstChild,d),d.parentNode.removeChild(d)}function k(o){var t,l=[];if(t=tinymce.toArray(q.getBody().getElementsByTagName("span")),t.length){for(var c=0;c<t.length;c++){var s=p(t[c]);null!==s&&s.length&&s===o.toString()&&l.push(t[c])}}return l}function f(i){var l=u,c=q.dom;i=i!==!1,i?l++:l--,c.removeClass(k(u),"mce-match-marker-selected");var d=k(l);return d.length?(c.addClass(k(l),"mce-match-marker-selected"),q.selection.scrollIntoView(d[0]),l):-1}function h(c){c.parentNode.removeChild(c)}var m=this,u=-1;m.init=function(c){c.addMenuItem("searchreplace",{text:"Find and replace",shortcut:"Ctrl+F",onclick:g,separator:"before",context:"edit"}),c.addButton("searchreplace",{tooltip:"Find and replace",shortcut:"Ctrl+F",onclick:g}),c.addCommand("SearchReplace",g),c.shortcuts.add("Ctrl+F","",g)},m.find=function(i,d,l){i=i.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),i=l?"\\b"+i+"\\b":i;var c=e(new RegExp(i,d?"g":"gi"));return c&&(u=-1,u=f(!0)),c},m.next=function(){var c=f(!0);-1!==c&&(u=c)},m.prev=function(){var c=f(!1);-1!==c&&(u=c)},m.replace=function(y,l,c){var i,w,A,t,s,v,d=u;for(l=l!==!1,A=q.getBody(),w=tinymce.toArray(A.getElementsByTagName("span")),i=0;i<w.length;i++){var z=p(w[i]);if(null!==z&&z.length){if(t=s=parseInt(z,10),c||t===u){for(y.length?(w[i].firstChild.nodeValue=y,j(w[i])):h(w[i]);w[++i];){if(t=p(w[i]),null!==z&&z.length){if(t!==s){i--;break}h(w[i])}}l&&d--}else{s>u&&w[i].setAttribute("data-mce-index",s-1)}}}return q.undoManager.add(),u=d,l?(v=k(d+1).length>0,m.next()):(v=k(d-1).length>0,m.prev()),!c&&v},m.done=function(t){var y,s,w,v;for(s=tinymce.toArray(q.getBody().getElementsByTagName("span")),y=0;y<s.length;y++){var i=p(s[y]);null!==i&&i.length&&(i===u.toString()&&(w||(w=s[y].firstChild),v=s[y].firstChild),j(s[y]))}if(w&&v){var x=q.dom.createRng();return x.setStart(w,0),x.setEnd(v,v.data.length),t!==!1&&q.selection.setRng(x),x}}}tinymce.PluginManager.add("searchreplace",a)}();