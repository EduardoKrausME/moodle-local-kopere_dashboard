tinymce.PluginManager.add("preview",function(c){var b=c.settings,a=!tinymce.Env.ie;c.addCommand("mcePreview",function(){c.windowManager.open({title:"Preview",width:parseInt(c.getParam("plugin_preview_width","650"),10),height:parseInt(c.getParam("plugin_preview_height","500"),10),html:'<iframe src="javascript:\'\'" frameborder="0"'+(a?' sandbox="allow-scripts"':"")+"></iframe>",buttons:{text:"Close",onclick:function(){this.parent().parent().close()}},onPostRender:function(){var d,g="";g+='<base href="'+c.documentBaseURI.getURI()+'">';tinymce.each(c.contentCSS,function(j){g+='<link type="text/css" rel="stylesheet" href="'+c.documentBaseURI.toAbsolute(j)+'">'});var h=b.body_id||"tinymce";if(h.indexOf("=")!=-1){h=c.getParam("body_id","","hash");h=h[c.id]||h}var f=b.body_class||"";if(f.indexOf("=")!=-1){f=c.getParam("body_class","","hash");f=f[c.id]||""}var e=c.settings.directionality?' dir="'+c.settings.directionality+'"':"";d=("<!DOCTYPE html><html><head>"+g+'</head><body id="'+h+'" class="mce-content-body '+f+'"'+e+">"+c.getContent()+"</body></html>");if(!a){var i=this.getEl("body").firstChild.contentWindow.document;i.open();i.write(d);i.close()}else{this.getEl("body").firstChild.src="data:text/html;charset=utf-8,"+encodeURIComponent(d)}}})});c.addButton("preview",{title:"Preview",cmd:"mcePreview"});c.addMenuItem("preview",{text:"Preview",cmd:"mcePreview",context:"view"})});