var capabilities=[];var models=[];function render(){document.getElementById("installer-results").style.display="none";document.getElementById("runbtn").style.display="none";document.getElementById("results-meta").style.display="block";if(capabilities.online){document.getElementById("warn_internet").style.display="none"}else{document.getElementById("warn_internet").style.display="block";return}if(capabilities.onserver){$("#warn_protocol").hide()}else{$("#warn_protocol").show();return}document.getElementById("installer-results").style.display="block";var n=true;var j="<h4>Test Results for PHP</h4>";if(capabilities.php){j+='<p>PHP Available: Yes <i class="glyphicon glyphicon-ok" style="color:green"></i></p>'}else{j+='<p>PHP Available: No <i class="glyphicon glyphicon-warning-sign" style="color:red"></i></p>';j+='<div class="alert alert-danger" >PHP is not installed on your server.  We suggest choosing another server language, or installing PHP Version 5 or above.</div>';n=false}if(n){if(capabilities.phpver>="5"){j+="<p>PHP Version: "+capabilities.phpver+' <i class="glyphicon glyphicon-ok" style="color:green"></i> running on '+capabilities.server+" </p>"}else{j+="<p>PHP Version: "+capabilities.phpver+' <i class="glyphicon glyphicon-warning-sign" style="color:red"></i></p>';j+='<div class="alert alert-danger" >This software required PHP version 5 or above.</div>';n=false}}if(n){if(capabilities.read_php){j+='<p>PHP Dictionary Read Permissions: Yes<i class="glyphicon glyphicon-ok" style="color:green"></i></p>'}else{j+='<p>PHP Dictionary Read Permissions: Permission Denied <i class="glyphicon glyphicon-warning-sign" style="color:red"></i></p>';j+='<div class="alert alert-danger" >Please allow the web server (or everyone) "READ" permissions to the nanospell/server/dictionaries folder and all files inside.</div>';n=false}}if(n){if(capabilities.dic_php.length){j+='<p>NanoSpell Dictionaries Installed: Yes <i class="glyphicon glyphicon-ok" style="color:green"></i>';j+="<ul>";var m=capabilities.dic_php.split(",");for(var f=0;f<m.length;f++){j+="<li>"+m[f]+"</li>"}j+='<li>  <a href="http://www.tinymcespellcheck.com/dictionaries" target="_blank"> Download More &raquo;</a></li>';j+="</ul> "}else{j+='<p>NanoSpell Dictionaries Installed: None <i class="glyphicon glyphicon-warning-sign" style="color:red"></i>';j+='<div class="alert alert-danger" >This is likely to be a file permissions issue, or simply the files have not been copied to the correct directory - which is "nanospell/server/dictionaries" .  You may also want to read tinymcespellcheck.com/dictionaries </div>';n=false}}if(n){$.ajax("server/ajax/php/tinyspell.php",{async:false,error:function(i){j+='<div class="alert alert-danger" >PHP is reporting a server error. <a href="server/ajax/php/tinyspell.php" target="_blank">Read the full error info &raquo;</a></div>';n=false}})}$("#php_results").html(j);if(n){$("#php_live").show();var o=document.location.pathname+"";var b=o.substring(o.lastIndexOf("/")+1);var c=o.replace(b,"plugin.js");$(".dynamic_url_for_plugin").html(c);tinymce.init({selector:"#php_live textarea",external_plugins:{nanospell:c}});$("#tab-php").html("<i class='glyphicon glyphicon-ok' style='color:green'></i> PHP")}var d=true;var e="<h4>Test Results for ASP VBScript</h4>";if(capabilities.asp){e+='<p>ASP Available: Yes <i class="glyphicon glyphicon-ok" style="color:green"></i></p>'}else{e+='<p>ASP Available: No <i class="glyphicon glyphicon-warning-sign" style="color:red"></i></p>';e+='<div class="alert alert-danger" >ASP does not appear to be running on your server.  If you are running on Windows IIS you may need to activate ASP in IIS Manager.  </div>';d=false}if(d){if(capabilities.read_asp){e+='<p>ASP Dictionary Read Permissions: Yes<i class="glyphicon glyphicon-ok" style="color:green"></i></p>'}else{e+='<p>ASP Dictionary Read Permissions: Permission Denied <i class="glyphicon glyphicon-warning-sign" style="color:red"></i></p>';e+='<div class="alert alert-danger" >Please allow the web server (or "Everyone") "READ" permissions to the nanospell/server/dictionaries folder and all files inside.</div>';d=false}}if(d){if(capabilities.dic_asp.length){e+='<p>NanoSpell Dictionaries Installed: Yes <i class="glyphicon glyphicon-ok" style="color:green"></i>';e+="<ul>";var m=capabilities.dic_asp.split(",");for(var f=0;f<m.length;f++){e+="<li>"+m[f]+"</li>"}e+='<li>  <a href="http://www.tinymcespellcheck.com/dictionaries" target="_blank"> Download More &raquo;</a></li>';e+="</ul> "}else{e+='<p>NanoSpell Dictionaries Installed: None <i class="glyphicon glyphicon-warning-sign" style="color:red"></i>';e+='<div class="alert alert-danger" >This is likely to be a file permissions issue, or simply the files have not been copied to the correct directory - which is "nanospell/server/dictionaries" .  You may also want to read tinymcespellcheck.com/dictionaries </div>';d=false}}if(d){$.ajax("server/ajax/asp/tinyspell.asp",{async:false,dataType:"json",error:function(p,q,i){e+='<div class="alert alert-danger" >ASP is reporting a server error. <a href="server/ajax/asp/tinyspell.asp" target="_blank">Read the full error info &raquo;</a></div>';d=false}})}$("#asp_results").html(e);if(d){$("#asp_live").show();var o=document.location.pathname+"";var b=o.substring(o.lastIndexOf("/")+1);var c=o.replace(b,"plugin.js");$(".mydynamic_url_for_plugindir").html(c);tinymce.init({selector:"#asp_live textarea",external_plugins:{nanospell:c},nanospell_server:"asp"});$("#tab-asp").html("<i class='glyphicon glyphicon-ok' style='color:green'></i> ASP")}var h=true;var l="<h4>Test Results for ASP.Net </h4>";if(capabilities.net){l+='<p>ASP.Net Available: Yes <i class="glyphicon glyphicon-ok" style="color:green"></i></p>'}else{l+='<p>ASP.Net Available: No <i class="glyphicon glyphicon-warning-sign" style="color:red"></i></p>';l+='<div class="alert alert-danger" >ASP.Net does not appear to be running on your server.   The  Software requires ASP.Net Framework version 2 or above. </div>';l+='<div class="alert alert-danger" >If ASP.Net is runnig then try copying <b>nanospell/bin/TinyMCESpell.dll</b> to your /bin folder and re-run this test. </div>';h=false}if(h){if(capabilities.dll){l+='<p>ASP.Net DLL: Installed<i class="glyphicon glyphicon-ok" style="color:green"></i></p>'}else{l+='<p>ASP.Net DLL: Not Yet Installed  <i class="glyphicon glyphicon-warning-sign" style="color:red"></i></p>';l+='<div class="alert alert-danger" >Copy <b>nanospell/bin/TinyMCESpell.dll</b> to your /bin folder and re-run this test.  The DLL requires ASP.Net Framework version 2 or above.</div>';h=false}}if(h){if(capabilities.read_net){l+='<p>ASP.Net Dictionary Read Permissions: Yes<i class="glyphicon glyphicon-ok" style="color:green"></i></p>'}else{l+='<p>ASP.Net Dictionary Read Permissions: Permission Denied <i class="glyphicon glyphicon-warning-sign" style="color:red"></i></p>';l+='<div class="alert alert-danger" >Please allow the web server (or "Everyone") "READ" permissions to the nanospell/server/dictionaries folder and all files inside.</div>';h=false}}if(h){if(capabilities.dic_net.length){l+='<p>NanoSpell Dictionaries Installed: Yes <i class="glyphicon glyphicon-ok" style="color:green"></i>';l+="<ul>";var m=capabilities.dic_net.split(",");for(var f=0;f<m.length;f++){l+="<li>"+m[f]+"</li>"}l+='<li>  <a href="http://www.tinymcespellcheck.com/dictionaries" target="_blank"> Download More &raquo;</a></li>';l+="</ul> "}else{l+='<p>NanoSpell Dictionaries Installed: None <i class="glyphicon glyphicon-warning-sign" style="color:red"></i>';l+='<div class="alert alert-danger" >This is likely to be a file permissions issue, or simply the files have not been copied to the correct directory - which is "nanospell/server/dictionaries" .  You may also want to read tinymcespellcheck.com/dictionaries </div>';h=false}}if(h){$.ajax("server/ajax/asp.net/tinyspell.aspx",{async:false,error:function(i){l+='<div class="alert alert-danger" >ASP.Net is reporting a server error. <a href="server/ajax/asp.net/tinyspell.aspx" target="_blank">Read the full error info &raquo;</a></div>';h=false}})}$("#net_results").html(l);if(h){$("#net_live").show();var o=document.location.pathname+"";var b=o.substring(o.lastIndexOf("/")+1);var c=o.replace(b,"plugin.js");$(".dynamic_url_for_plugin").html(c);tinymce.init({selector:"#net_live textarea",external_plugins:{nanospell:c},nanospell_server:"asp.net"});$("#tab-net").html("<i class='glyphicon glyphicon-ok' style='color:green'></i> ASP.Net")}if(h){$("#tab-net").tab("show")}else{if(n){$("#tab-php").tab("show")}else{if(d){$("#tab-asp").tab("show")}}}var k=0;k+=h?1:0;k+=n?1:0;k+=d?1:0;if(k){var a=k==1?"":"s";var g="On your system it looks like you have "+k+" installation option"+a+" which will work straight out of the box.  The other (unticked) installation options will need to be configured before use."}else{var g="On your system it looks like installation will require you to choose your optimal server language and carefully follow the instructions."}$("#infotop").html(g);$("html, body").animate({scrollTop:$("#results-meta").offset().top},300)}function runTests(){capabilities.onserver=location.href.toLowerCase().indexOf("file://")?true:false;capabilities.online=typeof($)!=="undefined"?true:false;capabilities.json=false;capabilities.php=false;capabilities.phpver=0;capabilities.dic_php="";capabilities.read_php="";capabilities.server="Unknown";capabilities.net=false;capabilities.dll=false;capabilities.dic_net="";capabilities.read_net="";capabilities.asp=false;capabilities.dic_asp="";capabilities.read_asp="";if(capabilities.onserver&&capabilities.online){testHostSystem(["server/installer/php.php","server/installer/asp.net.aspx","server/installer/asp.asp","server/installer/json.js"])}else{render()}}function testHostSystem(b){if(b.length==0){return render()}var a=b.pop();$.ajax(a,{dataType:"JSON"}).done(function(c){$.each(c,function(e,d){capabilities[e]=d})}).fail(function(){}).always(function(){return testHostSystem(b)})};