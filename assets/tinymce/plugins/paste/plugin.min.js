!function(L,w){function E(d,b){for(var f,c=[],a=0;a<d.length;++a){if(f=x[d[a]]||D(d[a]),!f){throw"module definition dependecy not found: "+d[a]}c.push(f)}b.apply(null,c)}function A(c,b,a){if("string"!=typeof c){throw"invalid module definition, module id must be defined and be a string"}if(b===w){throw"invalid module definition, dependencies must be specified"}if(a===w){throw"invalid module definition, definition function must be specified"}E(b,function(){x[c]=a.apply(null,arguments)})}function H(a){return !!x[a]}function D(b){for(var d=L,c=b.split(/[.\/]/),a=0;a<c.length;++a){if(!d[c[a]]){return}d=d[c[a]]}return d}function P(g){for(var e=0;e<g.length;e++){for(var d=L,f=g[e],c=f.split(/[.\/]/),b=0;b<c.length-1;++b){d[c[b]]===w&&(d[c[b]]={}),d=d[c[b]]}d[c[c.length-1]]=x[f]}}var x={},G="tinymce/pasteplugin/Utils",N="tinymce/util/Tools",M="tinymce/html/DomParser",q="tinymce/html/Schema",K="tinymce/pasteplugin/Clipboard",B="tinymce/Env",F="tinymce/util/VK",I="tinymce/pasteplugin/WordFilter",J="tinymce/html/Serializer",k="tinymce/html/Node",j="tinymce/pasteplugin/Quirks",O="tinymce/pasteplugin/Plugin",z="tinymce/PluginManager";A(G,[N,M,q],function(d,b,g){function c(e,h){return d.each(h,function(i){e=i.constructor==RegExp?e.replace(i,""):e.replace(i[0],i[1])}),e}function a(p){function m(l){var i=l.name,o=l;if("br"===i){return void (n+="\n")}if(e[i]&&(n+=" "),v[i]){return void (n+=" ")}if(3==l.type&&(n+=l.value),!l.shortEnded&&(l=l.firstChild)){do{m(l)}while(l=l.next)}t[i]&&o.next&&(n+="\n","p"==i&&(n+="\n"))}var u=new g,h=new b({},u),n="",e=u.getShortEndedElements(),v=d.makeMap("script noscript style textarea video audio iframe object"," "),t=u.getBlockElements();return m(h.parse(p)),n}function f(h){return h=c(h,[/^[\s\S]*<body[^>]*>\s*|\s*<\/body[^>]*>[\s\S]*$/g,/<!--StartFragment-->|<!--EndFragment-->/g,[/<span class="Apple-converted-space">\u00a0<\/span>/g,"\xa0"],/<br>$/i])}return{filter:c,innerText:a,trimHtml:f}}),A(K,[B,F,G],function(b,a,c){return function(U){function Z(g){var f,h=U.dom;if(f=U.fire("BeforePastePreProcess",{content:g}),f=U.fire("PastePreProcess",f),g=f.content,!f.isDefaultPrevented()){if(U.hasEventListeners("PastePostProcess")&&!f.isDefaultPrevented()){var d=h.add(U.getBody(),"div",{style:"display:none"},g);f=U.fire("PastePostProcess",{node:d}),h.remove(d),g=f.node.innerHTML}f.isDefaultPrevented()||U.insertContent(g,{merge:U.settings.paste_merge_formats!==!1})}}function W(g){g=U.dom.encode(g).replace(/\r\n/g,"\n");var f=U.dom.getParent(U.selection.getStart(),U.dom.isBlock),h=U.settings.forced_root_block,d;h&&(d=U.dom.createHTML(h,U.settings.forced_root_block_attrs),d=d.substr(0,d.length-3)+">"),f&&/^(PRE|DIV)$/.test(f.nodeName)||!h?g=c.filter(g,[[/\n/g,"<br>"]]):(g=c.filter(g,[[/\n\n/g,"</p>"+d],[/^(.*<\/p>)(<p>)$/,d+"$1"],[/\n/g,"<br />"]]),-1!=g.indexOf("<p>")&&(g=d+g)),Z(g)}function ag(){var h=U.dom,u=U.getBody(),g=U.dom.getViewPort(U.getWin()),p=g.y,f=20,m;if(af=U.selection.getRng(),U.inline&&(m=U.selection.getScrollContainer(),m&&m.scrollTop>0&&(p=m.scrollTop)),af.getClientRects){var d=af.getClientRects();if(d.length){f=p+(d[0].top-h.getPos(u).y)}else{f=p;var r=af.startContainer;r&&(3==r.nodeType&&r.parentNode!=u&&(r=r.parentNode),1==r.nodeType&&(f=h.getPos(r,m||u).y))}}e=h.add(U.getBody(),"div",{id:"mcepastebin",contentEditable:!0,"data-mce-bogus":"1",style:"position: absolute; top: "+f+"px;width: 10px; height: 10px; overflow: hidden; opacity: 0"},n),(b.ie||b.gecko)&&h.setStyle(e,"left","rtl"==h.getStyle(u,"direction",!0)?65535:-65535),h.bind(e,"beforedeactivate focusin focusout",function(i){i.stopPropagation()}),e.focus(),U.selection.select(e,!0)}function S(){if(e){for(var d;d=U.dom.get("mcepastebin");){U.dom.remove(d),U.dom.unbind(d)}af&&U.selection.setRng(af)}e=af=null}function Y(){var g=n,f,h;for(f=U.dom.select("div[id=mcepastebin]"),h=f.length;h--;){var d=f[h].innerHTML;g==n&&(g=""),d.length>g.length&&(g=d)}return g}function ae(h){var f={};if(h&&h.types){var l=h.getData("Text");l&&l.length>0&&(f["text/plain"]=l);for(var g=0;g<h.types.length;g++){var d=h.types[g];f[d]=h.getData(d)}}return f}function ad(d){return ae(d.clipboardData||U.getDoc().dataTransfer)}function R(g,f){function i(m){if("image/png"==h[d].type){var l=new FileReader;return l.onload=function(){Z('<img src="'+l.result+'">')},l.readAsDataURL(m.getAsFile()),!0}}if(!(!U.settings.paste_data_images||"text/html" in f||"text/plain" in f)&&g.clipboardData){var h=g.clipboardData.items;if(h){for(var d=0;d<h.length;d++){if(i(h[d])){return !0}}}}}function ac(f){var d=f.clipboardData;return -1!=navigator.userAgent.indexOf("Android")&&d&&d.items&&0===d.items.length}function V(g){var f=U.getDoc(),h;if(f.caretPositionFromPoint){var d=f.caretPositionFromPoint(g.clientX,g.clientY);h=f.createRange(),h.setStart(d.offsetNode,d.offset),h.collapse(!0)}else{f.caretRangeFromPoint&&(h=f.caretRangeFromPoint(g.clientX,g.clientY))}return h}function X(f,d){return d in f&&f[d].length>0}function aa(d){return a.metaKeyPressed(d)&&86==d.keyCode||d.shiftKey&&45==d.keyCode}function ab(){U.on("keydown",function(d){if(aa(d)&&!d.isDefaultPrevented()){if(t=d.shiftKey&&86==d.keyCode,t&&b.webkit&&-1!=navigator.userAgent.indexOf("Version/")){return}if(d.stopImmediatePropagation(),T=(new Date).getTime(),b.ie&&t){return d.preventDefault(),void U.fire("paste",{ieFake:!0})}S(),ag()}}),U.on("keyup",function(d){aa(d)&&!d.isDefaultPrevented()&&S()}),U.on("paste",function(d){var i=ad(d),g=(new Date).getTime()-T<1000,f="text"==Q.pasteFormat||t;return t=!1,d.isDefaultPrevented()||ac(d)?void S():R(d,i)?void S():(g||d.preventDefault(),!b.ie||g&&!d.ieFake||(ag(),U.dom.bind(e,"paste",function(h){h.stopPropagation()}),U.getDoc().execCommand("Paste",!1,null),i["text/html"]=Y()),void setTimeout(function(){var h;return X(i,"text/html")?h=i["text/html"]:(h=Y(),h==n&&(f=!0)),h=c.trimHtml(Y()),e&&e.firstChild&&"mcepastebin"===e.firstChild.id&&(f=!0),S(),f&&(h=X(i,"text/plain")&&-1==h.indexOf("</p>")?i["text/plain"]:c.innerText(h)),h==n?void (g||U.windowManager.alert("Please use Ctrl+V/Cmd+V keyboard shortcuts to paste contents.")):void (f?W(h):Z(h))},0))}),U.on("dragstart",function(f){if(f.dataTransfer.types){try{f.dataTransfer.setData("mce-internal",U.selection.getContent())}catch(d){}}}),U.on("drop",function(g){var f=V(g);if(f&&!g.isDefaultPrevented()){var h=ae(g.dataTransfer),d=h["mce-internal"]||h["text/html"]||h["text/plain"];d&&(g.preventDefault(),U.undoManager.transact(function(){h["mce-internal"]&&U.execCommand("Delete"),U.selection.setRng(f),h["text/html"]?Z(d):W(d)}))}})}var Q=this,e,af,T=0,n="%MCEPASTEBIN%",t;Q.pasteHtml=Z,Q.pasteText=W,U.on("preInit",function(){ab(),U.parser.addNodeFilter("img",function(f){if(!U.settings.paste_data_images){for(var g=f.length;g--;){var d=f[g].attributes.map.src;d&&0===d.indexOf("data:image")&&(f[g].attr("data-mce-object")||d===b.transparentSrc||f[g].remove())}}})}),U.on("BeforeAddUndo",function(d){d.level.content&&(d.level.content=d.level.content.replace(/<div id="?mcepastebin"?[^>]+>%MCEPASTEBIN%<\/div>/gi,""))})}}),A(I,[N,M,q,J,k,G],function(h,d,m,g,c,l){function b(a){return/<font face="Times New Roman"|class="?Mso|style="[^"]*\bmso-|style='[^'']*\bmso-|w:WordDocument/i.test(a)||/class="OutlineElement/.test(a)||/id="?docs\-internal\-guid\-/.test(a)}function f(e){var a=e.settings;e.on("BeforePastePreProcess",function(C){function t(U){function Z(ae,ac,ab,ad){var u=ae._listLevel||v;u!=v&&(v>u?y&&(y=y.parent.parent):(p=y,y=null)),y&&y.name==ab?y.append(ae):(p=p||y,y=new c(ab,1),ad>1&&y.attr("start",""+ad),ae.wrap(y)),ae.name="li",ac.value="";var af=ac.next;af&&3==af.type&&(af.value=af.value.replace(/^\u00a0+/,"")),u>v&&p&&p.lastChild.append(y),v=u}for(var y,p,v=1,X=U.getAll("p"),aa=0;aa<X.length;aa++){if(U=X[aa],"p"==U.name&&U.firstChild){for(var T="",W=U.firstChild;W&&!(T=W.value);){W=W.firstChild}if(/^\s*[\u2022\u00b7\u00a7\u00d8\u25CF]\s*$/.test(T)){Z(U,W,"ul");continue}if(/^\s*\w+\.$/.test(T)){var V=/([0-9])\./.exec(T),Y=1;V&&(Y=parseInt(V[1],10)),Z(U,W,"ol",Y);continue}y=null}}}function S(u,T){var v={},y=e.dom.parseStyle(T);if("p"===u.name){var p=/mso-list:\w+ \w+([0-9]+)/.exec(T);p&&(u._listLevel=parseInt(p[1],10))}return h.each(y,function(U,V){switch(V){case"horiz-align":V="text-align";break;case"vert-align":V="vertical-align";break;case"font-color":case"mso-foreground":V="color";break;case"mso-background":case"mso-highlight":V="background";break;case"font-weight":case"font-style":return void ("normal"!=U&&(v[V]=U));case"mso-element":if(/^(comment|comment-list)$/i.test(U)){return void u.remove()}}return 0===V.indexOf("mso-comment")?void u.remove():void (0!==V.indexOf("mso-")&&("all"==i||n&&n[V])&&(v[V]=U))}),/(bold)/i.test(v["font-weight"])&&(delete v["font-weight"],u.wrap(new c("b",1))),/(italic)/i.test(v["font-style"])&&(delete v["font-style"],u.wrap(new c("i",1))),v=e.dom.serializeStyle(v,u.name),v?v:null}var s=C.content,i,n;if(i=a.paste_retain_style_properties,i&&(n=h.makeMap(i.split(/[, ]/))),a.paste_enable_default_filters!==!1&&b(C.content)){C.wordContent=!0,s=l.filter(s,[/<!--[\s\S]+?-->/gi,/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,[/<(\/?)s>/gi,"<$1strike>"],[/&nbsp;/gi,"\xa0"],[/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s\u00a0]*)<\/span>/gi,function(u,p){return p.length>0?p.replace(/./," ").slice(Math.floor(p.length/2)).split("").join("\xa0"):""}]]);var o=a.paste_word_valid_elements;o||(o="-strong/b,-em/i,-span,-p,-ol,-ul,-li,-h1,-h2,-h3,-h4,-h5,-h6,-p/div,-table[width],-tr,-td[colspan|rowspan|width],-th,-thead,-tfoot,-tbody,-a[href|name],sub,sup,strike,br,del");var r=new m({valid_elements:o,valid_children:"-li[p]"});h.each(r.elements,function(p){p.attributes["class"]||(p.attributes["class"]={},p.attributesOrder.push("class")),p.attributes.style||(p.attributes.style={},p.attributesOrder.push("style"))});var R=new d({},r);R.addAttributeFilter("style",function(u){for(var p=u.length,v;p--;){v=u[p],v.attr("style",S(v,v.attr("style"))),"span"==v.name&&v.parent&&!v.attributes.length&&v.unwrap()}}),R.addAttributeFilter("class",function(v){for(var p=v.length,y,u;p--;){y=v[p],u=y.attr("class"),/^(MsoCommentReference|MsoCommentText|msoDel)$/i.test(u)&&y.remove(),y.attr("class",null)}}),R.addNodeFilter("del",function(u){for(var p=u.length;p--;){u[p].remove()}}),R.addNodeFilter("a",function(y){for(var u=y.length,T,v,p;u--;){if(T=y[u],v=T.attr("href"),p=T.attr("name"),v&&-1!=v.indexOf("#_msocom_")){T.remove()}else{if(v&&0===v.indexOf("file://")&&(v=v.split("#")[1],v&&(v="#"+v)),v||p){if(p&&!/^_?(?:toc|edn|ftn)/i.test(p)){T.unwrap();continue}T.attr({href:v,name:p})}else{T.unwrap()}}}});var Q=R.parse(s);t(Q),C.content=new g({},r).serialize(Q)}})}return f.isWordContent=b,f}),A(j,[B,N,I,G],function(c,a,d,b){return function(f){function h(i){f.on("BeforePastePreProcess",function(l){l.content=i(l.content)})}function e(l){if(!d.isWordContent(l)){return l}var m=[];a.each(f.schema.getBlockElements(),function(o,n){m.push(n)});var i=new RegExp("(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*(<\\/?("+m.join("|")+")[^>]*>)(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*","g");return l=b.filter(l,[[i,"$1"]]),l=b.filter(l,[[/<br><br>/g,"<BR><BR>"],[/<br>/g," "],[/<BR><BR>/g,"<br>"]])}function g(m){if(d.isWordContent(m)){return m}var i=f.settings.paste_webkit_styles;if(f.settings.paste_remove_styles_if_webkit===!1||"all"==i){return m}if(i&&(i=i.split(/[, ]/)),i){var l=f.dom,n=f.selection.getNode();m=m.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,function(t,o,r,C){var R=l.parseStyle(r,"span"),p={};if("none"===i){return o+C}for(var y=0;y<i.length;y++){var v=R[i[y]],Q=l.getStyle(n,i[y],!0);/color/.test(i[y])&&(v=l.toHex(v),Q=l.toHex(Q)),Q!=v&&(p[i[y]]=v)}return p=l.serializeStyle(p,"span"),p?o+' style="'+p+'"'+C:""})}else{m=m.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,"$1$3")}return m=m.replace(/(<[^>]+) data-mce-style="([^"]+)"([^>]*>)/gi,function(s,o,u,p){return o+' style="'+u+'"'+p})}c.webkit&&h(g),c.ie&&h(e)}}),A(O,[z,K,I,j],function(d,b,f,c){var a;d.add("paste",function(m){function n(){"text"==i.pasteFormat?(this.active(!1),i.pasteFormat="html"):(i.pasteFormat="text",this.active(!0),a||(m.windowManager.alert("Paste is now in plain text mode. Contents will now be pasted as plain text until you toggle this option off."),a=!0))}var h=this,i,g=m.settings;h.clipboard=i=new b(m),h.quirks=new c(m),h.wordFilter=new f(m),m.settings.paste_as_text&&(h.clipboard.pasteFormat="text"),g.paste_preprocess&&m.on("PastePreProcess",function(l){g.paste_preprocess.call(h,h,l)}),g.paste_postprocess&&m.on("PastePostProcess",function(l){g.paste_postprocess.call(h,h,l)}),m.addCommand("mceInsertClipboardContent",function(o,l){l.content&&h.clipboard.pasteHtml(l.content),l.text&&h.clipboard.pasteText(l.text)}),m.paste_block_drop&&m.on("dragend dragover draggesture dragdrop drop drag",function(l){l.preventDefault(),l.stopPropagation()}),m.settings.paste_data_images||m.on("drop",function(o){var l=o.dataTransfer;l&&l.files&&l.files.length>0&&o.preventDefault()}),m.addButton("pastetext",{icon:"pastetext",tooltip:"Paste as text",onclick:n,active:"text"==h.clipboard.pasteFormat}),m.addMenuItem("pastetext",{text:"Paste as text",selectable:!0,active:i.pasteFormat,onclick:n})})}),P([G,I])}(this);